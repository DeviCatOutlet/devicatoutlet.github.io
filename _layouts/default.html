<!doctype html>
<html lang="en">
  <head>
    <title>DeviCat Outlet</title>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css" integrity="sha384-PsH8R72JQ3SOdhVi3uxftmaW6Vc51MKb0q5P2rRUpPvrszuE4W1povHYgTpBfshb" crossorigin="anonymous">
    <link rel="stylesheet" href="css/main.css">
    <link rel="icon" href="https://static-cdn.jtvnw.net/emoticons/v1/819883/3.0">

  </head>

  <body class="{{ page.category | default: "devi" }}-cat">

    <!-- Navigation -->
    <!-- Hamburger menu styling and technique inspired by https://codepen.io/erikterwan/pen/EVzeRP by Erik Terwan and made available under the terms of the MIT license -->
    <nav>
      <input type=checkbox>
      <div id=raptor_button><div></div><div></div><div></div></div>
      <a class=keep href="/"><img src="img/mainbanner.png" alt="DeviCat"></a>
      <div style="flex-grow: 1"></div>
      {%- for dest in site.nav %}{%- for info in dest -%}
        {%- if info[1] -%}
          {%- assign name = info[0] -%}
          {%- assign url = info[1] -%}
        {%- else -%}
          {%- assign name = dest -%}
          {%- assign url = dest | downcase | replace: " ", "" -%}
        {%- endif -%}
        {% assign active = "" %}{% assign current = "" %}
        {%- if page.title == name %}{% assign active = " active" %}{% assign current = '<span class="sr-only">(current)</span>' %}{% endif %}
        {%- if info[1].first -%}
          {%- comment %} It's an array of subpages (eg Characters) {% endcomment %}
          {%- assign url = name | downcase | replace: " ", "" %}
          <div class="nav-menucontainer">
            <a class="nav-dropdown {{active}}" href="{{ url }}" id="dropdown-{{ url }}" role="button" aria-haspopup="true" aria-expanded="false">{{ name }}{{current}}</a>
            <div class="nav-submenu" aria-labelledby="dropdown-{{ url }}">
              {%- for subdest in info[1] -%}
                {%- assign url = subdest | downcase | replace: " ", "" | replace: ",", "-" %}
                <a href="{{ url }}">{{ subdest }}</a>
              {%- endfor %}
            </div>
          </div>
        {%- else -%}
          {%- comment %} It's a single page (maybe with a specified URL) {% endcomment %}
          <a class="{{active}}" href="{{ url }}">{{ name }}{{ current }}</a>
        {%- endif %}
      {%- endfor %}{% endfor %}
    </nav>
    {% if page.title == "Home" %}
    <section class="jumbotron text-center parallax">
      <h2 class="sr-only">Embedded Twitch stream</h2>
      <div></div>
      <div><iframe title="Watch DeviCat live!" src="https://player.twitch.tv?channel=devicat" allowfullscreen="" style="border: 0" allow="autoplay; fullscreen" width="768" height="432"></iframe></div>
      <div>
        <a href="https://www.patreon.com/devicatoutlet"><img src="img/patreon.png" alt="Become a Patron"></a><br>
        <a href="https://discord.gg/devicat"><img src="img/discord.png" alt="Join the discussion"></a>
      </div>
      <div></div>
    </section>
    {% endif %}

  <main>
      {% if page.Character %}
      <h1>{{ page.Character }}</h1>
      {% if page.Subtitle %}<h1>({{ page.Subtitle }})</h1>{% endif %}
      <ul class="layout">
      {% for info in page.Info %}<li><strong>{{ info[0] }}:</strong> {{ info[1] }}</li>{% endfor %}
      </ul>
      {% endif %}
      {{ content }}
  </main>

<div id=fader></div>
<div id="popup"><div><img src="https://static-cdn.jtvnw.net/emoticons/v1/819883/3.0" alt="[placeholder]" role="presentation"><div id="popup-caption"></div></div></div>

<footer>
  <p>
    <a href="https://twitch.tv/DeviCat" aria-label="Twitch: DeviCat"><i class="fab fa-twitch fa-2x" title="Twitch: DeviCat"></i></a>
    <a href="https://www.instagram.com/devicatoutlet/" aria-label="Instagram: DeviCatOutlet"><i class="fab fa-instagram fa-2x" title="Instagram: DeviCatOutlet"></i></a>
    <a href="https://twitter.com/DeviCatOutlet" aria-label="Twitter: DeviCatOutlet"><i class="fab fa-twitter fa-2x" title="Twitter: DeviCatOutlet"></i></a>
    <a href="https://www.youtube.com/DeviCatTV" aria-label="Youtube: DeviCatTV"><i class="fab fa-youtube fa-2x" title="Youtube: DeviCatTV"></i></a>
    <a href="https://discord.gg/devicat" aria-label="Discord: DeviCat"><i class="fab fa-discord fa-2x" title="Discord: DeviCat"></i></a>
    <a href="https://www.patreon.com/devicatoutlet" aria-label="Patreon: DeviCatOutlet"><i class="fab fa-patreon fa-2x" title="Patreon: DeviCatOutlet"></i></a>
  </p>
  <p>&copy; DeviCat Outlet 2018</p>
</footer>
<script defer src="https://use.fontawesome.com/releases/v5.0.3/js/all.js"></script>
<script>
document.querySelectorAll('#gallery ~ p img').forEach(img => img.onclick = function(ev) {
	document.querySelector('#popup img').src = this.src;
	//document.getElementById('#modal-caption').textContent = this.alt; //TODO: Style these up nicely and then enable them
	document.documentElement.classList.add("show-modal");
	ev.stopPropagation();
});
document.querySelectorAll('.nav-dropdown').forEach(a => a.onclick = function(ev) {
	//Collapse other dropdowns, and toggle this one (so there's a max of one open at a time)
	document.querySelectorAll('.nav-dropdown').forEach(a => a != this && a.setAttribute('aria-expanded', 'false'));
	this.setAttribute('aria-expanded', this.getAttribute('aria-expanded') != "true");
	ev.stopPropagation(); ev.preventDefault();
});
document.documentElement.onclick = function(ev) {
	this.classList.remove("show-modal");
	document.querySelectorAll('.nav-dropdown').forEach(a => a.setAttribute('aria-expanded', 'false'));
	//Also collapse the Raptor menu (applicable only on narrow screens) if you click outside nav
	if (!ev.target.closest("nav")) document.querySelector("nav input").checked = false;
}
</script>
</body>
</html>
